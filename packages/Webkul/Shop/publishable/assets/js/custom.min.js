$(window).on("scroll", function () {
    if (window.pageYOffset > 250) {
        $("header").addClass("sticky");
    } else {
        $("header").removeClass("sticky");
    }
})
gsap.registerPlugin(ScrollTrigger);
// Product Detail Counter
$('.minus').click(function () {
    var $input = $(this).parent().find('input');
    var count = parseInt($input.val()) - 1;
    count = count < 1 ? 1 : count;
    $input.val(count);
    $input.change();
    return false;
});
$('.plus').click(function () {
    var $input = $(this).parent().find('input');
    $input.val(parseInt($input.val()) + 1);
    $input.change();
    return false;
});


function imgRevealer() {
    let revealContainers = document.querySelectorAll(".reveal");

    revealContainers.forEach((container) => {
        let image = container.querySelector("img");
        let revelerTl = gsap.timeline({
            scrollTrigger: {
                // scroller: '[data-scroll-container]',
                trigger: container,
                toggleActions: "restart none none reverse",
            }
        });

        revelerTl.set(container, {autoAlpha: 1});
        revelerTl.from(container, .75, {
            xPercent: -100,
            ease: Power2.out
        });
        revelerTl.from(image, .75, {
            xPercent: 100,
            scale: 1.3,
            delay: -.75,
            ease: Power2.out
        });
    });
}

imgRevealer();

$('[data-fancybox]').fancybox({
    // Options will go here
    buttons: [
        "zoom",
        "fullScreen",
        "download",
        'close',
    ],
    wheel: false,
    transitionEffect: "slide",
    // thumbs          : false,
    // hash            : false,
    loop: true,
    // keyboard        : true,
    toolbar: true,
    // animationEffect : false,
    // arrows          : true,
    clickContent: false

});

$(".testimonialSlider").slick({
    autoplay: true,
    autoplaySpeed: 5000,
    dots: true,
    arrows: true,
    infinite: true,
    slidesToShow: 3,
    slidesToScroll: 1,
    prevArrow: '<button type="button" class="slick-prev"><i class="fal fa-chevron-left"></i></button>',
    nextArrow: '<button type="button" class="slick-next"><i class="fal fa-chevron-right"></i></button>',
    responsive: [
        {
            breakpoint: 1199,
            settings: {
                slidesToShow: 3,
            },
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: false,
            },
        },
        {
            breakpoint: 575,
            settings: {
                slidesToShow: 1,
                arrows: false,
            },
        },
    ],
});

function preloader() {

    const tl = gsap.timeline({duration: 0.10});
    tl
        .to('.preLoader.black > img',
            {
                delay: 1,
                y: 50,
                autoAlpha: 0,
            }
        )
        .to('.preLoader.black',
            {
                yPercent: -100,
            },
        )
        .to('.preLoader.white',
            {
                xPercent: -100,
            }
        )
        .to(".preLoader",
            {
                css: {
                    display: 'none'
                }
            }
        )
        .from('.navbar-brand > img',
            {
                x: -50,
                autoAlpha: 0
            }
        )
        .from('.navbar-nav > li, .form-inline a',
            {
                autoAlpha: 0,
                y: -100,
                stagger: 0.05,
            }, '>-0.5'
        )
        // .fromTo(['.main-slider h1', '.main-slider h2', '.main-slider p', '.main-slider .themeBtn'], {
        //     autoAlpha: 0,
        //     y: '35px',
        // }, {
        //     stagger: 0.01,
        //     // duration: 0.5,
        //     ease: "power2.in",
        //     autoAlpha: 1,
        //     y: '0px',
        // }, '>-0.2')
        .from('.btmImg',
            {
                autoAlpha: 0,
                yPercent: 100,
                stagger: 0.05,
            }
        )
}

$(".product-detail-slider").slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: true,
    fade: true,
    adaptiveHeight: true,
    asNavFor: ".product-detail-nav",
});
$(".product-detail-nav").slick({
    slidesToShow: 3,
    slidesToScroll: 1,
    asNavFor: ".product-detail-slider",
    dots: false,
    focusOnSelect: true,
    prevArrow:
        "<button type='button' class='slick-prev pull-left'><i class='fa fa-angle-left' aria-hidden='true'></i></button>",
    nextArrow:
        "<button type='button' class='slick-next pull-right'><i class='fa fa-angle-right' aria-hidden='true'></i></button>",
});

// function initialization
$(window).on('load', function () {
        preloader();
});
var sliderThumbnail = new Swiper('.brakeSliderNav', {
    autoplay: {
        delay: 3000
    },
    loop: true,
    grabCursor: true,
    slidesPerView: 5,
    freeMode: true,
    watchSlidesVisibility: true,
    watchSlidesProgress: true,
});

//スライダー
var slider = new Swiper('.brakeSlider', {
    autoplay: {
        delay: 3000
    },
    loop: true,
    grabCursor: true,
    navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
    },
    thumbs: {
        swiper: sliderThumbnail
    }
});

let minImgs = document.querySelectorAll('.productsRow .minImgs')
let mainImg = document.querySelector(".productImgMain .mainImg img")
minImgs.forEach((img) => {
    $(img).on("click", function () {
        let src = $(this).find("img")[0].src
        console.log(src)
        mainImg.src = src;
    })
})

function removeLink(message) {
    if (!confirm(message)) {
        event.preventDefault();
        return;
    }
}

$('.addQty').on('click', function () {
    console.log($(this).data('id'), $(this).data('qty') + 1)
    $('[name="product_id"]').val($(this).data('id'));
    $(this).attr('disabled', true);
    document.getElementById('add-to-cart').submit()
});

$('.rmvQty').on('click', function () {
    console.log($(this).data('id'), $(this).data('qty') - 1)
    $('[name="item_id"]').val($(this).data('id'));
    $('[name="quantity"]').val($(this).data('qty') - 1);
    $(this).attr('disabled', true);
    document.getElementById('remove-to-cart').submit()
});

$('.proc-to-pay').on('click', function () {
    $(this).css("pointer-events", "none").text('Processing...');
});